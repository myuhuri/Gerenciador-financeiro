<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor financeiro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #282b30;
            --bg-secondary: #1e2124;
            --bg-card: #36393e;
            --accent-primary: #003366;
            --accent-secondary: #0055aa;
            --text-primary: #ffffff;
            --text-secondary: #b9bbbe;
            --success: #43b581;
            --success-light: #52d692;
            --warning: #faa61a;
            --danger: #f04747;
            --info: #5d80d6;
            --purple: #b294bb;
            --border-radius: 12px;
            --shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 12px 24px rgba(0, 0, 0, 0.4);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary) 0%, #1a1c20 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 25px;
            border-bottom: 2px solid var(--accent-primary);
            position: relative;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 3px;
        }

        h1 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .card {
            background: linear-gradient(145deg, var(--bg-card), #2e3136);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
            border-color: var(--accent-secondary);
        }

        .card h2 {
            color: var(--text-primary);
            margin-bottom: 25px;
            font-size: 1.7rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card h2 i {
            color: var(--accent-secondary);
            font-size: 1.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 25px 20px;
            text-align: center;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-3px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
        }

        .stat-debt .stat-icon { background: rgba(240, 71, 71, 0.15); color: var(--danger); }
        .stat-income .stat-icon { background: rgba(67, 181, 129, 0.15); color: var(--success); }
        .stat-balance .stat-icon { background: rgba(0, 85, 170, 0.15); color: var(--accent-secondary); }
        .stat-due .stat-icon { background: rgba(250, 166, 26, 0.15); color: var(--warning); }

        .stat-card h3 {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            line-height: 1.2;
        }

        .positive { color: var(--success-light); }
        .negative { color: var(--danger); }
        .neutral { color: var(--accent-secondary); }
        .warning { color: var(--warning); }

        .filters-section {
            background: linear-gradient(145deg, var(--bg-card), #2e3136);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .filter-group label {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select, input, button, textarea {
            padding: 16px 20px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
            outline: none;
        }

        select:focus, input:focus, textarea:focus {
            border-color: var(--accent-secondary);
            background: rgba(0, 85, 170, 0.1);
            box-shadow: 0 0 0 3px rgba(0, 85, 170, 0.2);
        }

        button {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::after {
            width: 300px;
            height: 300px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 85, 170, 0.3);
        }

        button:active {
            transform: translateY(-1px);
        }

        button.secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        button.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-secondary);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #ff5555);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), var(--success-light));
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #ffb53a);
        }

        .btn-info {
            background: linear-gradient(135deg, var(--info), #6d8fe0);
        }

        .btn-purple {
            background: linear-gradient(135deg, var(--purple), #c9a6d4);
        }

        .filter-actions {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
            padding: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: linear-gradient(145deg, var(--bg-card), #2e3136);
            padding: 40px;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        @keyframes slideUp {
            from { transform: translateY(50px) scale(0.95); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header h2 {
            color: var(--text-primary);
            font-size: 2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: var(--text-secondary);
            font-size: 2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            transform: rotate(90deg);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }

        .checkbox-group:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--accent-secondary);
        }

        .checkbox-group input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: var(--accent-secondary);
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-primary);
        }

        .paid-toggle {
            margin-top: 15px;
        }

        .paid-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(67, 181, 129, 0.15);
            color: var(--success-light);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 15px;
            border: 2px solid rgba(67, 181, 129, 0.3);
        }

        .paid-badge i {
            font-size: 0.9rem;
        }

        .tabs-container {
            background: linear-gradient(145deg, var(--bg-card), #2e3136);
            border-radius: var(--border-radius);
            overflow: hidden;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.03);
            overflow-x: auto;
            scrollbar-width: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 20px 30px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            min-width: 200px;
            justify-content: center;
        }

        .tab:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            color: var(--accent-secondary);
            border-bottom: 3px solid var(--accent-secondary);
            background: rgba(0, 85, 170, 0.05);
        }

        .tab-badge {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .tab.active .tab-badge {
            background: var(--accent-secondary);
            color: white;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .categories-container {
            display: grid;
            gap: 25px;
        }

        .category-card {
            background: linear-gradient(145deg, var(--bg-card), #2e3136);
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }

        .category-card:hover {
            border-color: var(--accent-secondary);
            transform: translateY(-5px);
        }

        .category-header {
            background: rgba(255, 255, 255, 0.03);
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .category-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .category-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .category-info h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .category-type {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
        }

        .type-debt { background: rgba(240, 71, 71, 0.15); color: var(--danger); }
        .type-income { background: rgba(67, 181, 129, 0.15); color: var(--success-light); }

        .category-total {
            font-size: 2rem;
            font-weight: 800;
            text-align: right;
        }

        .category-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .subcategories-container {
            padding: 20px;
        }

        .subcategory-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }

        .subcategory-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--accent-secondary);
        }

        .subcategory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .subcategory-header h4 {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subcategory-total {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .accounts-list {
            display: grid;
            gap: 12px;
        }

        .account-item {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            border: 2px solid transparent;
            transition: var(--transition);
        }

        .account-item:hover {
            background: rgba(255, 255, 255, 0.04);
            border-color: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .account-item.paid {
            opacity: 0.7;
            background: rgba(67, 181, 129, 0.05);
            border-color: rgba(67, 181, 129, 0.2);
        }

        .account-info {
            flex: 1;
            min-width: 300px;
        }

        .account-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .account-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .account-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .badge-installment { background: rgba(93, 128, 214, 0.15); color: var(--info); }
        .badge-paid { background: rgba(67, 181, 129, 0.15); color: var(--success-light); }
        .badge-overdue { background: rgba(240, 71, 71, 0.15); color: var(--danger); }

        .account-details {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .account-detail {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .account-value {
            font-size: 1.8rem;
            font-weight: 800;
            min-width: 150px;
            text-align: right;
        }

        .account-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 10px 16px;
            font-size: 0.9rem;
            border-radius: 8px;
            min-width: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .no-data {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-secondary);
        }

        .no-data i {
            font-size: 5rem;
            margin-bottom: 25px;
            opacity: 0.2;
        }

        .no-data h3 {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .no-data p {
            font-size: 1.1rem;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .confirmation-modal {
            text-align: center;
        }

        .confirmation-icon {
            font-size: 5rem;
            margin-bottom: 25px;
        }

        .danger-icon { color: var(--danger); }
        .warning-icon { color: var(--warning); }
        .success-icon { color: var(--success); }

        .confirmation-text {
            font-size: 1.3rem;
            margin-bottom: 35px;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .confirmation-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .status-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .status-filter-btn {
            padding: 12px 25px;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-filter-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .status-filter-btn.active {
            background: var(--accent-secondary);
            color: white;
            border-color: var(--accent-secondary);
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            
            .card {
                padding: 25px 20px;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .category-header, .subcategory-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .category-total {
                text-align: left;
                align-self: flex-start;
            }
            
            .account-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .account-value {
                text-align: left;
                width: 100%;
            }
            
            .confirmation-actions {
                flex-direction: column;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                min-width: 100%;
                justify-content: flex-start;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .stat-value {
                font-size: 1.8rem;
            }
            
            .modal-content {
                padding: 25px 15px;
            }
            
            .account-info {
                min-width: 100%;
            }
            
            .filter-actions {
                flex-direction: column;
            }
            
            button {
                padding: 14px 18px;
            }
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Gestor financeiro</h1>
            <p class="subtitle">Controle de finanças :D</p>
        </header>

        <div class="dashboard-grid">
            <div class="card">
                <h2><i class="fas fa-chart-line"></i> Visão Geral</h2>
                <div class="stats-grid">
                    <div class="stat-card stat-debt">
                        <div class="stat-icon">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <h3>Dívidas Pendentes</h3>
                        <div class="stat-value negative" id="total-debts">R$ 0,00</div>
                    </div>
                    <div class="stat-card stat-income">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3>Entradas Pendentes</h3>
                        <div class="stat-value positive" id="total-incomes">R$ 0,00</div>
                    </div>
                    <div class="stat-card stat-balance">
                        <div class="stat-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <h3>Saldo Previsto</h3>
                        <div class="stat-value neutral" id="total-balance">R$ 0,00</div>
                    </div>
                    <div class="stat-card stat-due">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-exclamation"></i>
                        </div>
                        <h3>Próximos 7 Dias</h3>
                        <div class="stat-value warning" id="next-due">R$ 0,00</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-tachometer-alt"></i> Resumo Rápido</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(178, 148, 187, 0.15); color: var(--purple);">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3>Dívidas Pagas</h3>
                        <div class="stat-value" id="paid-debts">R$ 0,00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(250, 166, 26, 0.15); color: var(--warning);">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h3>Entradas Recebidas</h3>
                        <div class="stat-value" id="received-incomes">R$ 0,00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(93, 128, 214, 0.15); color: var(--info);">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <h3>Fixos Pendentes</h3>
                        <div class="stat-value" id="pending-fixed">R$ 0,00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(67, 181, 129, 0.15); color: var(--success);">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3>Rendas Totais</h3>
                        <div class="stat-value" id="total-salaries">R$ 0,00</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="filters-section">
            <div class="filters-grid">
                <div class="filter-group">
                    <label for="filter-period"><i class="fas fa-calendar-alt"></i> Período</label>
                    <select id="filter-period">
                        <option value="all">Todos os períodos</option>
                        <option value="today">Hoje</option>
                        <option value="week">Esta semana</option>
                        <option value="month">Este mês</option>
                        <option value="next-month">Próximo mês</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-type"><i class="fas fa-filter"></i> Tipo</label>
                    <select id="filter-type">
                        <option value="all">Todos os tipos</option>
                        <option value="debt">Dívidas</option>
                        <option value="income">Entradas</option>
                        <option value="fixed">Gastos Fixos</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-category"><i class="fas fa-tags"></i> Categoria</label>
                    <select id="filter-category">
                        <option value="all">Todas categorias</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filter-status"><i class="fas fa-check-circle"></i> Status</label>
                    <select id="filter-status">
                        <option value="all">Todos os status</option>
                        <option value="pending">Pendentes</option>
                        <option value="paid">Pagas/Recebidas</option>
                        <option value="overdue">Atrasadas</option>
                    </select>
                </div>
            </div>
            <div class="filter-actions">
                <button id="apply-filters" class="btn-success"><i class="fas fa-filter"></i> Aplicar Filtros</button>
                <button id="reset-filters" class="secondary"><i class="fas fa-redo"></i> Limpar Filtros</button>
                <button id="toggle-paid" class="btn-purple"><i class="fas fa-eye-slash"></i> Ocultar Pagas</button>
            </div>
        </div>

        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" data-tab="transactions">
                    <i class="fas fa-exchange-alt"></i> Transações
                    <span class="tab-badge" id="transactions-count">0</span>
                </button>
                <button class="tab" data-tab="fixed-expenses">
                    <i class="fas fa-calendar-check"></i> Gastos Fixos
                    <span class="tab-badge" id="fixed-expenses-count">0</span>
                </button>
                <button class="tab" data-tab="salary">
                    <i class="fas fa-money-check-alt"></i> Entradas Fixas
                    <span class="tab-badge" id="salary-count">0</span>
                </button>
            </div>

            <div class="tab-content active" id="transactions-tab">
                <div class="quick-actions">
                    <button id="add-category-btn" class="btn-info">
                        <i class="fas fa-folder-plus"></i> Nova Categoria
                    </button>
                    <button id="add-subcategory-btn" class="btn-info">
                        <i class="fas fa-tag"></i> Nova Subcategoria
                    </button>
                    <button id="add-account-btn" class="btn-success">
                        <i class="fas fa-receipt"></i> Nova Conta
                    </button>
                    <button id="mark-all-paid" class="btn-purple">
                        <i class="fas fa-check-double"></i> Marcar Todas como Pagas
                    </button>
                </div>

                <div class="status-filters">
                    <button class="status-filter-btn active" data-status="all">
                        <i class="fas fa-list"></i> Todas
                    </button>
                    <button class="status-filter-btn" data-status="pending">
                        <i class="fas fa-clock"></i> Pendentes
                    </button>
                    <button class="status-filter-btn" data-status="paid">
                        <i class="fas fa-check-circle"></i> Pagas
                    </button>
                    <button class="status-filter-btn" data-status="overdue">
                        <i class="fas fa-exclamation-triangle"></i> Atrasadas
                    </button>
                </div>

                <div class="categories-container" id="categories-container">
                    <div class="no-data" id="no-data">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <h3>Nenhuma transação cadastrada</h3>
                        <p>Comece adicionando uma categoria para organizar suas finanças</p>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="fixed-expenses-tab">
                <div class="quick-actions">
                    <button id="add-fixed-expense-btn" class="btn-warning">
                        <i class="fas fa-plus-circle"></i> Adicionar Gasto Fixo
                    </button>
                </div>
                <div class="fixed-expenses-list" id="fixed-expenses-list">
                </div>
            </div>

            <div class="tab-content" id="salary-tab">
                <div class="quick-actions">
                    <button id="add-salary-btn" class="btn-success">
                        <i class="fas fa-plus-circle"></i> Adicionar Entrada Fixa
                    </button>
                </div>
                <div class="salary-list" id="salary-list">
                </div>
            </div>
        </div>

        <div class="footer">
            <p><i class="fas fa-database"></i> Todos os dados são salvos localmente no seu navegador</p>
            <p style="margin-top: 10px; font-size: 0.85rem; opacity: 0.7;">Sistema Completo de Gestão Financeira</p>
        </div>
    </div>

    <div class="modal" id="category-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-folder"></i> Nova Categoria</h2>
                <button class="close-btn" id="close-category-modal">&times;</button>
            </div>
            <form id="category-form">
                <div class="form-group">
                    <label for="category-name"><i class="fas fa-heading"></i> Nome da Categoria</label>
                    <input type="text" id="category-name" placeholder="Ex: Compras, Lazer, Transporte" required>
                </div>
                <div class="form-group">
                    <label for="category-type"><i class="fas fa-tag"></i> Tipo</label>
                    <select id="category-type" required>
                        <option value="debt">Dívida</option>
                        <option value="income">Entrada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="category-color"><i class="fas fa-palette"></i> Cor da Categoria</label>
                    <input type="color" id="category-color" value="#003366">
                </div>
                <button type="submit" class="btn-success"><i class="fas fa-save"></i> Salvar Categoria</button>
            </form>
        </div>
    </div>

    <div class="modal" id="subcategory-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-tags"></i> Nova Subcategoria</h2>
                <button class="close-btn" id="close-subcategory-modal">&times;</button>
            </div>
            <form id="subcategory-form">
                <div class="form-group">
                    <label for="subcategory-name"><i class="fas fa-heading"></i> Nome da Subcategoria</label>
                    <input type="text" id="subcategory-name" placeholder="Ex: Boticário, Supermercado" required>
                </div>
                <div class="form-group">
                    <label for="subcategory-category"><i class="fas fa-folder"></i> Categoria</label>
                    <select id="subcategory-category" required>
                    </select>
                </div>
                <button type="submit" class="btn-success"><i class="fas fa-save"></i> Salvar Subcategoria</button>
            </form>
        </div>
    </div>

    <div class="modal" id="account-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-file-invoice-dollar"></i> Nova Conta</h2>
                <button class="close-btn" id="close-account-modal">&times;</button>
            </div>
            <form id="account-form">
                <div class="form-group">
                    <label for="account-description"><i class="fas fa-align-left"></i> Descrição</label>
                    <input type="text" id="account-description" placeholder="Ex: Perfume, Conta de Luz" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="account-total-value"><i class="fas fa-money-bill-wave"></i> Valor Total (R$)</label>
                        <input type="number" id="account-total-value" min="0" step="0.01" placeholder="0,00" required>
                    </div>
                    <div class="form-group">
                        <label for="account-date"><i class="fas fa-calendar-day"></i> Data de Vencimento</label>
                        <input type="date" id="account-date" required>
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="account-is-installment">
                    <label for="account-is-installment"><i class="fas fa-credit-card"></i> Esta conta é parcelada?</label>
                </div>
                <div id="installment-fields" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="installment-total"><i class="fas fa-list-ol"></i> Total de Parcelas</label>
                            <input type="number" id="installment-total" min="2" max="60" value="2">
                        </div>
                        <div class="form-group">
                            <label for="installment-current"><i class="fas fa-hashtag"></i> Parcela Atual</label>
                            <input type="number" id="installment-current" min="1" value="1">
                        </div>
                    </div>
                    <div class="form-group" style="background: rgba(93, 128, 214, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid var(--info);">
                        <label><i class="fas fa-calculator"></i> Cálculo Automático</label>
                        <div style="margin-top: 10px; font-size: 1.1rem;">
                            <div>Valor da parcela: <strong id="installment-value-calc">R$ 0,00</strong></div>
                            <div>Próximas parcelas: <strong id="remaining-installments">0</strong></div>
                        </div>
                    </div>
                </div>
                <div class="checkbox-group paid-toggle">
                    <input type="checkbox" id="account-paid">
                    <label for="account-paid"><i class="fas fa-check-circle"></i> Esta conta já está paga/recebida?</label>
                </div>
                <div class="form-group">
                    <label for="account-category"><i class="fas fa-folder"></i> Categoria</label>
                    <select id="account-category" required>
                    </select>
                </div>
                <div class="form-group">
                    <label for="account-subcategory"><i class="fas fa-tags"></i> Subcategoria</label>
                    <select id="account-subcategory" required>
                    </select>
                </div>
                <button type="submit" class="btn-success"><i class="fas fa-save"></i> Salvar Conta</button>
            </form>
        </div>
    </div>

    <div class="modal" id="fixed-expense-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-calendar-check"></i> Novo Gasto Fixo</h2>
                <button class="close-btn" id="close-fixed-expense-modal">&times;</button>
            </div>
            <form id="fixed-expense-form">
                <div class="form-group">
                    <label for="fixed-expense-name"><i class="fas fa-heading"></i> Nome do Gasto</label>
                    <input type="text" id="fixed-expense-name" placeholder="Ex: Aluguel, Internet, Academia" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="fixed-expense-value"><i class="fas fa-money-bill-wave"></i> Valor Mensal (R$)</label>
                        <input type="number" id="fixed-expense-value" min="0" step="0.01" placeholder="0,00" required>
                    </div>
                    <div class="form-group">
                        <label for="fixed-expense-day"><i class="fas fa-calendar-day"></i> Dia do Vencimento</label>
                        <input type="number" id="fixed-expense-day" min="1" max="31" placeholder="1 a 31" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="fixed-expense-category"><i class="fas fa-folder"></i> Categoria</label>
                    <select id="fixed-expense-category" required>
                    </select>
                </div>
                <div class="checkbox-group paid-toggle">
                    <input type="checkbox" id="fixed-expense-paid">
                    <label for="fixed-expense-paid"><i class="fas fa-check-circle"></i> Este gasto já está pago?</label>
                </div>
                <div class="form-group">
                    <label for="fixed-expense-description"><i class="fas fa-align-left"></i> Descrição (Opcional)</label>
                    <textarea id="fixed-expense-description" rows="3" placeholder="Detalhes sobre este gasto fixo..."></textarea>
                </div>
                <button type="submit" class="btn-warning"><i class="fas fa-save"></i> Salvar Gasto Fixo</button>
            </form>
        </div>
    </div>

    <div class="modal" id="salary-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-money-check-alt"></i> Nova Entrada Fixa</h2>
                <button class="close-btn" id="close-salary-modal">&times;</button>
            </div>
            <form id="salary-form">
                <div class="form-group">
                    <label for="salary-name"><i class="fas fa-heading"></i> Fonte de Renda</label>
                    <input type="text" id="salary-name" placeholder="Ex: Salário, Freelance, Empréstimo" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="salary-value"><i class="fas fa-money-bill-wave"></i> Valor (R$)</label>
                        <input type="number" id="salary-value" min="0" step="0.01" placeholder="0,00" required>
                    </div>
                    <div class="form-group">
                        <label for="salary-day"><i class="fas fa-calendar-day"></i> Dia do Recebimento</label>
                        <input type="number" id="salary-day" min="1" max="31" placeholder="1 a 31" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="salary-frequency"><i class="fas fa-history"></i> Frequência</label>
                    <select id="salary-frequency" required>
                        <option value="monthly">Mensal</option>
                        <option value="biweekly">Quinzenal</option>
                        <option value="weekly">Semanal</option>
                        <option value="daily">Diária</option>
                        <option value="single">Única vez</option>
                    </select>
                </div>
                <div class="checkbox-group paid-toggle">
                    <input type="checkbox" id="salary-received">
                    <label for="salary-received"><i class="fas fa-check-circle"></i> Esta entrada já foi recebida?</label>
                </div>
                <div class="form-group">
                    <label for="salary-description"><i class="fas fa-align-left"></i> Descrição (Opcional)</label>
                    <textarea id="salary-description" rows="3" placeholder="Detalhes sobre esta fonte de renda..."></textarea>
                </div>
                <button type="submit" class="btn-success"><i class="fas fa-save"></i> Salvar Entrada</button>
            </form>
        </div>
    </div>

    <div class="modal" id="confirmation-modal">
        <div class="modal-content confirmation-modal">
            <div class="confirmation-icon" id="confirmation-icon">
                <i class="fas fa-exclamation-triangle danger-icon"></i>
            </div>
            <h2 id="confirmation-title">Confirmação</h2>
            <p class="confirmation-text" id="confirmation-text">Tem certeza que deseja realizar esta ação?</p>
            <div class="confirmation-actions">
                <button id="confirm-action" class="btn-danger"><i class="fas fa-check"></i> Confirmar</button>
                <button id="cancel-action" class="secondary"><i class="fas fa-times"></i> Cancelar</button>
            </div>
        </div>
    </div>

    <script>
        let finances = {
            categorias: [],
            gastosFixos: [],
            salarios: []
        };

        let appState = {
            editingCategoryId: null,
            editingSubcategoryId: null,
            editingAccountId: null,
            editingFixedExpenseId: null,
            editingSalaryId: null,
            currentCategoryId: null,
            filters: {
                period: 'all',
                type: 'all',
                category: 'all',
                status: 'all',
                showPaid: true
            },
            pendingAction: null
        };

        const categoryColors = [
            '#003366', '#0055aa', '#43b581', '#faa61a', '#f04747',
            '#5d80d6', '#b294bb', '#de4c8a', '#ff6b6b', '#4ecdc4'
        ];

        const categoryIcons = [
            'fa-shopping-cart', 'fa-home', 'fa-car', 'fa-utensils', 'fa-gamepad',
            'fa-heart', 'fa-graduation-cap', 'fa-briefcase-medical', 'fa-plane', 'fa-gift'
        ];

        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
            setupTabs();
            setupStatusFilters();
            renderAll();
            updateFilterOptions();
            
            const today = new Date();
            document.getElementById('account-date').value = today.toISOString().split('T')[0];
            
            setupInstallmentCalculation();
        });

        function setupInstallmentCalculation() {
            const totalValueInput = document.getElementById('account-total-value');
            const installmentTotalInput = document.getElementById('installment-total');
            const installmentCurrentInput = document.getElementById('installment-current');
            
            function updateInstallmentCalc() {
                const totalValue = parseFloat(totalValueInput.value) || 0;
                const totalInstallments = parseInt(installmentTotalInput.value) || 2;
                const currentInstallment = parseInt(installmentCurrentInput.value) || 1;
                
                const installmentValue = totalValue / totalInstallments;
                const remainingInstallments = totalInstallments - currentInstallment + 1;
                
                document.getElementById('installment-value-calc').textContent = `R$ ${installmentValue.toFixed(2)}`;
                document.getElementById('remaining-installments').textContent = `${remainingInstallments} parcela(s)`;
            }
            
            totalValueInput.addEventListener('input', updateInstallmentCalc);
            installmentTotalInput.addEventListener('input', updateInstallmentCalc);
            installmentCurrentInput.addEventListener('input', updateInstallmentCalc);
            
            updateInstallmentCalc();
        }

        function loadData() {
            const savedData = localStorage.getItem('financaControlPro');
            if (savedData) {
                finances = JSON.parse(savedData);
            }
        }

        function saveData() {
            localStorage.setItem('financaControlPro', JSON.stringify(finances));
        }

        function setupTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        function setupStatusFilters() {
            document.querySelectorAll('.status-filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.status-filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const status = this.getAttribute('data-status');
                    appState.filters.status = status;
                    renderCategories();
                });
            });
        }

        function setupEventListeners() {
            document.getElementById('add-category-btn').addEventListener('click', () => openModal('category'));
            document.getElementById('add-subcategory-btn').addEventListener('click', () => openModal('subcategory'));
            document.getElementById('add-account-btn').addEventListener('click', () => openModal('account'));
            document.getElementById('add-fixed-expense-btn').addEventListener('click', () => openModal('fixed-expense'));
            document.getElementById('add-salary-btn').addEventListener('click', () => openModal('salary'));
            document.getElementById('mark-all-paid').addEventListener('click', markAllAsPaid);
            document.getElementById('toggle-paid').addEventListener('click', toggleShowPaid);
            
            document.getElementById('apply-filters').addEventListener('click', applyFilters);
            document.getElementById('reset-filters').addEventListener('click', resetFilters);
            
            document.getElementById('close-category-modal').addEventListener('click', () => closeModal('category'));
            document.getElementById('close-subcategory-modal').addEventListener('click', () => closeModal('subcategory'));
            document.getElementById('close-account-modal').addEventListener('click', () => closeModal('account'));
            document.getElementById('close-fixed-expense-modal').addEventListener('click', () => closeModal('fixed-expense'));
            document.getElementById('close-salary-modal').addEventListener('click', () => closeModal('salary'));
            
            document.getElementById('category-form').addEventListener('submit', handleCategorySubmit);
            document.getElementById('subcategory-form').addEventListener('submit', handleSubcategorySubmit);
            document.getElementById('account-form').addEventListener('submit', handleAccountSubmit);
            document.getElementById('fixed-expense-form').addEventListener('submit', handleFixedExpenseSubmit);
            document.getElementById('salary-form').addEventListener('submit', handleSalarySubmit);
            
            document.getElementById('account-is-installment').addEventListener('change', function() {
                document.getElementById('installment-fields').style.display = this.checked ? 'block' : 'none';
                setupInstallmentCalculation();
            });
            
            document.getElementById('confirm-action').addEventListener('click', executePendingAction);
            document.getElementById('cancel-action').addEventListener('click', () => closeModal('confirmation'));
            
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
        }

        function markAllAsPaid() {
            showConfirmation(
                () => {
                    let updated = false;
                    finances.categorias.forEach(categoria => {
                        categoria.subcategorias.forEach(subcategoria => {
                            subcategoria.contas.forEach(conta => {
                                if (!conta.paga) {
                                    conta.paga = true;
                                    conta.dataPagamentoRealizada = new Date().toISOString().split('T')[0];
                                    updated = true;
                                }
                            });
                        });
                    });
                    
                    if (updated) {
                        saveData();
                        renderAll();
                        updateDashboard();
                        alert('Todas as contas foram marcadas como pagas/recebidas!');
                    } else {
                        alert('Todas as contas já estão marcadas como pagas/recebidas!');
                    }
                },
                'Marcar Todas como Pagas',
                'Deseja marcar TODAS as contas como pagas/recebidas? Esta ação não pode ser desfeita.',
                'warning'
            );
        }

        function toggleShowPaid() {
            appState.filters.showPaid = !appState.filters.showPaid;
            const btn = document.getElementById('toggle-paid');
            btn.innerHTML = appState.filters.showPaid ? 
                '<i class="fas fa-eye-slash"></i> Ocultar Pagas' : 
                '<i class="fas fa-eye"></i> Mostrar Pagas';
            renderCategories();
        }

        function openModal(type, data = null) {
            const modal = document.getElementById(`${type}-modal`);
            const title = modal.querySelector('h2');
            
            if (type === 'category') {
                title.innerHTML = data ? '<i class="fas fa-edit"></i> Editar Categoria' : '<i class="fas fa-folder-plus"></i> Nova Categoria';
                if (data) {
                    document.getElementById('category-name').value = data.nome;
                    document.getElementById('category-type').value = data.tipo;
                    document.getElementById('category-color').value = data.color || categoryColors[0];
                    appState.editingCategoryId = data.id;
                } else {
                    document.getElementById('category-form').reset();
                    const colorIndex = finances.categorias.length % categoryColors.length;
                    document.getElementById('category-color').value = categoryColors[colorIndex];
                    appState.editingCategoryId = null;
                }
            } else if (type === 'subcategory') {
                title.innerHTML = data ? '<i class="fas fa-edit"></i> Editar Subcategoria' : '<i class="fas fa-tag"></i> Nova Subcategoria';
                populateCategoryOptions('subcategory-category');
                if (data) {
                    document.getElementById('subcategory-name').value = data.nome;
                    document.getElementById('subcategory-category').value = appState.currentCategoryId || finances.categorias[0]?.id || '';
                    appState.editingSubcategoryId = data.id;
                } else {
                    document.getElementById('subcategory-form').reset();
                    appState.editingSubcategoryId = null;
                }
            } else if (type === 'account') {
                title.innerHTML = data ? '<i class="fas fa-edit"></i> Editar Conta' : '<i class="fas fa-file-invoice-dollar"></i> Nova Conta';
                populateCategoryOptions('account-category');
                if (data) {
                    document.getElementById('account-description').value = data.descricao;
                    document.getElementById('account-total-value').value = data.valorTotal || data.valor;
                    document.getElementById('account-date').value = data.dataPagamento;
                    document.getElementById('account-category').value = data.categoriaId || finances.categorias[0]?.id || '';
                    populateSubcategoryOptions('account-subcategory', data.categoriaId);
                    document.getElementById('account-subcategory').value = data.subcategoryId;
                    document.getElementById('account-paid').checked = data.paga || false;
                    
                    if (data.parcelamento) {
                        document.getElementById('account-is-installment').checked = true;
                        document.getElementById('installment-fields').style.display = 'block';
                        document.getElementById('installment-total').value = data.parcelamento.total;
                        document.getElementById('installment-current').value = data.parcelamento.atual;
                        setupInstallmentCalculation();
                    } else {
                        document.getElementById('account-is-installment').checked = false;
                        document.getElementById('installment-fields').style.display = 'none';
                    }
                    
                    appState.editingAccountId = data.id;
                } else {
                    document.getElementById('account-form').reset();
                    document.getElementById('account-date').value = new Date().toISOString().split('T')[0];
                    document.getElementById('account-is-installment').checked = false;
                    document.getElementById('installment-fields').style.display = 'none';
                    document.getElementById('account-paid').checked = false;
                    appState.editingAccountId = null;
                }
            } else if (type === 'fixed-expense') {
                title.innerHTML = data ? '<i class="fas fa-edit"></i> Editar Gasto Fixo' : '<i class="fas fa-calendar-check"></i> Novo Gasto Fixo';
                populateCategoryOptions('fixed-expense-category', 'debt');
                if (data) {
                    document.getElementById('fixed-expense-name').value = data.nome;
                    document.getElementById('fixed-expense-value').value = data.valor;
                    document.getElementById('fixed-expense-day').value = data.diaVencimento;
                    document.getElementById('fixed-expense-category').value = data.categoriaId || '';
                    document.getElementById('fixed-expense-description').value = data.descricao || '';
                    document.getElementById('fixed-expense-paid').checked = data.paga || false;
                    appState.editingFixedExpenseId = data.id;
                } else {
                    document.getElementById('fixed-expense-form').reset();
                    document.getElementById('fixed-expense-day').value = new Date().getDate();
                    document.getElementById('fixed-expense-paid').checked = false;
                    appState.editingFixedExpenseId = null;
                }
            } else if (type === 'salary') {
                title.innerHTML = data ? '<i class="fas fa-edit"></i> Editar Entrada' : '<i class="fas fa-money-check-alt"></i> Nova Entrada';
                if (data) {
                    document.getElementById('salary-name').value = data.nome;
                    document.getElementById('salary-value').value = data.valor;
                    document.getElementById('salary-day').value = data.diaPagamento;
                    document.getElementById('salary-frequency').value = data.frequencia;
                    document.getElementById('salary-description').value = data.descricao || '';
                    document.getElementById('salary-received').checked = data.recebida || false;
                    appState.editingSalaryId = data.id;
                } else {
                    document.getElementById('salary-form').reset();
                    document.getElementById('salary-day').value = new Date().getDate();
                    document.getElementById('salary-received').checked = false;
                    appState.editingSalaryId = null;
                }
            }
            
            modal.style.display = 'flex';
        }

        function closeModal(type) {
            document.getElementById(`${type}-modal`).style.display = 'none';
        }

        function populateCategoryOptions(selectId, tipo = null) {
            const select = document.getElementById(selectId);
            select.innerHTML = '<option value="">Selecione uma categoria</option>';
            
            finances.categorias.forEach(categoria => {
                if (tipo && categoria.tipo !== tipo) return;
                
                const option = document.createElement('option');
                option.value = categoria.id;
                option.textContent = categoria.nome;
                option.style.color = categoria.color || categoryColors[0];
                select.appendChild(option);
            });
            
            if (selectId === 'account-category') {
                select.addEventListener('change', function() {
                    populateSubcategoryOptions('account-subcategory', this.value);
                });
            }
        }

        function populateSubcategoryOptions(selectId, categoryId) {
            const select = document.getElementById(selectId);
            select.innerHTML = '<option value="">Selecione uma subcategoria</option>';
            
            if (!categoryId) return;
            
            const categoria = finances.categorias.find(cat => cat.id == categoryId);
            if (categoria && categoria.subcategorias) {
                categoria.subcategorias.forEach(subcategoria => {
                    const option = document.createElement('option');
                    option.value = subcategoria.id;
                    option.textContent = subcategoria.nome;
                    select.appendChild(option);
                });
            }
        }

        function showConfirmation(action, title, message, icon = 'warning') {
            document.getElementById('confirmation-title').textContent = title;
            document.getElementById('confirmation-text').textContent = message;
            
            const iconElement = document.getElementById('confirmation-icon');
            iconElement.innerHTML = '';
            
            if (icon === 'danger') {
                iconElement.innerHTML = '<i class="fas fa-exclamation-triangle danger-icon"></i>';
                document.getElementById('confirm-action').className = 'btn-danger';
            } else if (icon === 'warning') {
                iconElement.innerHTML = '<i class="fas fa-question-circle warning-icon"></i>';
                document.getElementById('confirm-action').className = 'btn-warning';
            } else {
                iconElement.innerHTML = '<i class="fas fa-info-circle info-icon"></i>';
                document.getElementById('confirm-action').className = 'btn-info';
            }
            
            appState.pendingAction = action;
            document.getElementById('confirmation-modal').style.display = 'flex';
        }

        function executePendingAction() {
            if (appState.pendingAction) {
                appState.pendingAction();
            }
            closeModal('confirmation');
        }

        function handleCategorySubmit(e) {
            e.preventDefault();
            
            const nome = document.getElementById('category-name').value.trim();
            const tipo = document.getElementById('category-type').value;
            const color = document.getElementById('category-color').value;
            
            if (appState.editingCategoryId) {
                const categoria = finances.categorias.find(cat => cat.id == appState.editingCategoryId);
                if (categoria) {
                    categoria.nome = nome;
                    categoria.tipo = tipo;
                    categoria.color = color;
                }
            } else {
                const novaCategoria = {
                    id: Date.now(),
                    nome: nome,
                    tipo: tipo,
                    color: color,
                    subcategorias: []
                };
                finances.categorias.push(novaCategoria);
            }
            
            saveData();
            renderAll();
            updateFilterOptions();
            closeModal('category');
        }

        function handleSubcategorySubmit(e) {
            e.preventDefault();
            
            const nome = document.getElementById('subcategory-name').value.trim();
            const categoriaId = document.getElementById('subcategory-category').value;
            
            if (!categoriaId) {
                alert('Selecione uma categoria!');
                return;
            }
            
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            if (appState.editingSubcategoryId) {
                const subcategoria = categoria.subcategorias.find(sub => sub.id == appState.editingSubcategoryId);
                if (subcategoria) {
                    subcategoria.nome = nome;
                }
            } else {
                const novaSubcategoria = {
                    id: Date.now(),
                    nome: nome,
                    contas: []
                };
                categoria.subcategorias.push(novaSubcategoria);
            }
            
            saveData();
            renderAll();
            closeModal('subcategory');
        }

        function handleAccountSubmit(e) {
            e.preventDefault();
            
            const descricao = document.getElementById('account-description').value.trim();
            const valorTotal = parseFloat(document.getElementById('account-total-value').value);
            const dataPagamento = document.getElementById('account-date').value;
            const categoriaId = document.getElementById('account-category').value;
            const subcategoriaId = document.getElementById('account-subcategory').value;
            const isInstallment = document.getElementById('account-is-installment').checked;
            const isPaid = document.getElementById('account-paid').checked;
            
            if (!categoriaId || !subcategoriaId) {
                alert('Selecione uma categoria e subcategoria!');
                return;
            }
            
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            const subcategoria = categoria.subcategorias.find(sub => sub.id == subcategoriaId);
            if (!subcategoria) return;
            
            let parcelamento = null;
            let valorParcela = valorTotal;
            
            if (isInstallment) {
                const total = parseInt(document.getElementById('installment-total').value);
                const atual = parseInt(document.getElementById('installment-current').value);
                
                if (atual > total) {
                    alert('A parcela atual não pode ser maior que o total de parcelas!');
                    return;
                }
                
                valorParcela = valorTotal / total;
                parcelamento = {
                    total: total,
                    atual: atual,
                    valorParcela: valorParcela,
                    valorTotal: valorTotal,
                    idOriginal: appState.editingAccountId || Date.now()
                };
                
                if (appState.editingAccountId) {
                    subcategoria.contas = subcategoria.contas.filter(conta => 
                        !conta.parcelamento || conta.parcelamento.idOriginal !== parcelamento.idOriginal
                    );
                }
                
                for (let i = atual; i <= total; i++) {
                    const parcelaDate = new Date(dataPagamento);
                    parcelaDate.setMonth(parcelaDate.getMonth() + (i - atual));
                    
                    const novaParcela = {
                        id: appState.editingAccountId && i === atual ? appState.editingAccountId : Date.now() + i,
                        descricao: `${descricao} (${i}/${total})`,
                        valor: valorParcela,
                        valorTotal: valorTotal,
                        dataPagamento: parcelaDate.toISOString().split('T')[0],
                        categoriaId: categoriaId,
                        subcategoryId: subcategoriaId,
                        paga: isPaid,
                        dataPagamentoRealizada: isPaid ? new Date().toISOString().split('T')[0] : null,
                        parcelamento: {
                            idOriginal: parcelamento.idOriginal,
                            total: total,
                            atual: i,
                            valorParcela: valorParcela,
                            valorTotal: valorTotal
                        }
                    };
                    
                    if (i === atual) {
                        if (appState.editingAccountId) {
                            const conta = subcategoria.contas.find(acc => acc.id == appState.editingAccountId);
                            if (conta) {
                                Object.assign(conta, novaParcela);
                            } else {
                                subcategoria.contas.push(novaParcela);
                            }
                        } else {
                            subcategoria.contas.push(novaParcela);
                        }
                    } else {
                        subcategoria.contas.push(novaParcela);
                    }
                }
            } else {
                if (appState.editingAccountId) {
                    const conta = subcategoria.contas.find(acc => acc.id == appState.editingAccountId);
                    if (conta) {
                        Object.assign(conta, {
                            descricao: descricao,
                            valor: valorTotal,
                            valorTotal: valorTotal,
                            dataPagamento: dataPagamento,
                            paga: isPaid,
                            dataPagamentoRealizada: isPaid ? new Date().toISOString().split('T')[0] : null
                        });
                        delete conta.parcelamento;
                    }
                } else {
                    const novaConta = {
                        id: Date.now(),
                        descricao: descricao,
                        valor: valorTotal,
                        valorTotal: valorTotal,
                        dataPagamento: dataPagamento,
                        categoriaId: categoriaId,
                        subcategoryId: subcategoriaId,
                        paga: isPaid,
                        dataPagamentoRealizada: isPaid ? new Date().toISOString().split('T')[0] : null
                    };
                    subcategoria.contas.push(novaConta);
                }
            }
            
            saveData();
            renderAll();
            updateDashboard();
            closeModal('account');
        }

        function handleFixedExpenseSubmit(e) {
            e.preventDefault();
            
            const nome = document.getElementById('fixed-expense-name').value.trim();
            const valor = parseFloat(document.getElementById('fixed-expense-value').value);
            const diaVencimento = parseInt(document.getElementById('fixed-expense-day').value);
            const categoriaId = document.getElementById('fixed-expense-category').value;
            const descricao = document.getElementById('fixed-expense-description').value.trim();
            const isPaid = document.getElementById('fixed-expense-paid').checked;
            
            if (!categoriaId) {
                alert('Selecione uma categoria!');
                return;
            }
            
            if (appState.editingFixedExpenseId) {
                const gasto = finances.gastosFixos.find(g => g.id == appState.editingFixedExpenseId);
                if (gasto) {
                    gasto.nome = nome;
                    gasto.valor = valor;
                    gasto.diaVencimento = diaVencimento;
                    gasto.categoriaId = categoriaId;
                    gasto.descricao = descricao;
                    gasto.paga = isPaid;
                }
            } else {
                const novoGastoFixo = {
                    id: Date.now(),
                    nome: nome,
                    valor: valor,
                    diaVencimento: diaVencimento,
                    categoriaId: categoriaId,
                    descricao: descricao,
                    paga: isPaid,
                    ativo: true
                };
                finances.gastosFixos.push(novoGastoFixo);
            }
            
            saveData();
            renderAll();
            updateDashboard();
            closeModal('fixed-expense');
        }

        function handleSalarySubmit(e) {
            e.preventDefault();
            
            const nome = document.getElementById('salary-name').value.trim();
            const valor = parseFloat(document.getElementById('salary-value').value);
            const diaPagamento = parseInt(document.getElementById('salary-day').value);
            const frequencia = document.getElementById('salary-frequency').value;
            const descricao = document.getElementById('salary-description').value.trim();
            const isReceived = document.getElementById('salary-received').checked;
            
            if (appState.editingSalaryId) {
                const salario = finances.salarios.find(s => s.id == appState.editingSalaryId);
                if (salario) {
                    salario.nome = nome;
                    salario.valor = valor;
                    salario.diaPagamento = diaPagamento;
                    salario.frequencia = frequencia;
                    salario.descricao = descricao;
                    salario.recebida = isReceived;
                }
            } else {
                const novoSalario = {
                    id: Date.now(),
                    nome: nome,
                    valor: valor,
                    diaPagamento: diaPagamento,
                    frequencia: frequencia,
                    descricao: descricao,
                    recebida: isReceived,
                    ativo: true
                };
                finances.salarios.push(novoSalario);
            }
            
            saveData();
            renderAll();
            updateDashboard();
            closeModal('salary');
        }

        function renderAll() {
            renderCategories();
            renderFixedExpenses();
            renderSalaries();
            updateDashboard();
            updateCounts();
        }

        function renderCategories() {
            const container = document.getElementById('categories-container');
            
            let visibleCategories = finances.categorias.filter(categoria => {
                if (appState.filters.category !== 'all' && appState.filters.category != categoria.id) {
                    return false;
                }
                
                if (appState.filters.type !== 'all') {
                    if (appState.filters.type === 'debt' && categoria.tipo !== 'debt') return false;
                    if (appState.filters.type === 'income' && categoria.tipo !== 'income') return false;
                }
                
                return true;
            });
            
            if (visibleCategories.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <h3>Nenhuma transação encontrada</h3>
                        <p>Adicione uma categoria ou ajuste os filtros</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            visibleCategories.forEach(categoria => {
                const iconIndex = categoria.id % categoryIcons.length;
                const icon = categoryIcons[iconIndex];
                
                let categoriaTotal = 0;
                let categoriaTotalPago = 0;
                let subcategoriasHtml = '';
                
                categoria.subcategorias.forEach(subcategoria => {
                    let contasFiltradas = subcategoria.contas.filter(conta => {
                        if (conta.categoriaId != categoria.id) return false;
                        
                        if (appState.filters.period !== 'all') {
                            const contaDate = new Date(conta.dataPagamento);
                            const now = new Date();
                            
                            switch (appState.filters.period) {
                                case 'today':
                                    return contaDate.toDateString() === now.toDateString();
                                case 'week':
                                    const startOfWeek = new Date(now);
                                    startOfWeek.setDate(now.getDate() - now.getDay());
                                    const endOfWeek = new Date(startOfWeek);
                                    endOfWeek.setDate(startOfWeek.getDate() + 6);
                                    return contaDate >= startOfWeek && contaDate <= endOfWeek;
                                case 'month':
                                    return contaDate.getMonth() === now.getMonth() && 
                                           contaDate.getFullYear() === now.getFullYear();
                                case 'next-month':
                                    const nextMonth = now.getMonth() === 11 ? 0 : now.getMonth() + 1;
                                    const nextYear = now.getMonth() === 11 ? now.getFullYear() + 1 : now.getFullYear();
                                    return contaDate.getMonth() === nextMonth && 
                                           contaDate.getFullYear() === nextYear;
                                default:
                                    return true;
                            }
                        }
                        
                        return true;
                    });
                    
                    contasFiltradas = contasFiltradas.filter(conta => {
                        const now = new Date();
                        const contaDate = new Date(conta.dataPagamento);
                        const isOverdue = !conta.paga && contaDate < now;
                        
                        switch (appState.filters.status) {
                            case 'pending':
                                return !conta.paga && !isOverdue;
                            case 'paid':
                                return conta.paga;
                            case 'overdue':
                                return isOverdue;
                            default:
                                return true;
                        }
                    });
                    
                    if (!appState.filters.showPaid && appState.filters.status !== 'paid') {
                        contasFiltradas = contasFiltradas.filter(conta => !conta.paga);
                    }
                    
                    if (contasFiltradas.length === 0) return;
                    
                    let subcategoriaTotal = 0;
                    let subcategoriaTotalPago = 0;
                    let contasHtml = '';
                    
                    contasFiltradas.forEach(conta => {
                        subcategoriaTotal += conta.valor;
                        if (conta.paga) subcategoriaTotalPago += conta.valor;
                        
                        const now = new Date();
                        const contaDate = new Date(conta.dataPagamento);
                        const isOverdue = !conta.paga && contaDate < now;
                        
                        const valorTotal = conta.valorTotal || conta.valor;
                        const isInstallment = conta.parcelamento;
                        
                        contasHtml += `
                            <div class="account-item ${conta.paga ? 'paid' : ''}">
                                <div class="account-info">
                                    <div class="account-header">
                                        <div class="account-title">${conta.descricao}</div>
                                        <div class="account-badges">
                                            ${isInstallment ? 
                                                `<span class="badge badge-installment">
                                                    <i class="fas fa-credit-card"></i> ${conta.parcelamento.atual}/${conta.parcelamento.total}
                                                </span>` : ''}
                                            ${conta.paga ? 
                                                `<span class="badge badge-paid">
                                                    <i class="fas fa-check-circle"></i> ${categoria.tipo === 'debt' ? 'Paga' : 'Recebida'}
                                                </span>` : ''}
                                            ${isOverdue ? 
                                                `<span class="badge badge-overdue">
                                                    <i class="fas fa-exclamation-triangle"></i> Atrasada
                                                </span>` : ''}
                                        </div>
                                    </div>
                                    <div class="account-details">
                                        <div class="account-detail">
                                            <i class="far fa-calendar-alt"></i>
                                            ${formatDate(conta.dataPagamento)}
                                            ${conta.paga && conta.dataPagamentoRealizada ? ` (${categoria.tipo === 'debt' ? 'Paga' : 'Recebida'} em: ${formatDate(conta.dataPagamentoRealizada)})` : ''}
                                        </div>
                                        ${isInstallment ? 
                                            `<div class="account-detail">
                                                <i class="fas fa-calculator"></i>
                                                Valor total: R$ ${valorTotal.toFixed(2)} | Parcela: R$ ${conta.valor.toFixed(2)}
                                            </div>` : ''}
                                    </div>
                                </div>
                                <div class="account-value ${categoria.tipo === 'debt' ? 'negative' : 'positive'}">
                                    R$ ${conta.valor.toFixed(2)}
                                </div>
                                <div class="account-actions">
                                    ${!conta.paga ? `
                                        <button class="action-btn btn-success" onclick="markAsPaid(${conta.categoriaId}, ${conta.subcategoryId}, ${conta.id})">
                                            <i class="fas fa-check"></i> ${categoria.tipo === 'debt' ? 'Pagar' : 'Receber'}
                                        </button>
                                    ` : `
                                        <button class="action-btn btn-warning" onclick="markAsPending(${conta.categoriaId}, ${conta.subcategoryId}, ${conta.id})">
                                            <i class="fas fa-undo"></i> Desmarcar
                                        </button>
                                    `}
                                    <button class="action-btn btn-warning" onclick="editAccount(${conta.categoriaId}, ${conta.subcategoryId}, ${conta.id})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn btn-danger" onclick="showConfirmation(
                                        () => deleteAccount(${conta.categoriaId}, ${conta.subcategoryId}, ${conta.id}),
                                        'Excluir Conta',
                                        'Tem certeza que deseja excluir a conta \"${conta.descricao}\"?',
                                        'danger'
                                    )">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                    
                    categoriaTotal += subcategoriaTotal;
                    categoriaTotalPago += subcategoriaTotalPago;
                    
                    subcategoriasHtml += `
                        <div class="subcategory-card">
                            <div class="subcategory-header">
                                <h4><i class="fas fa-tag"></i> ${subcategoria.nome}</h4>
                                <div class="subcategory-total ${categoria.tipo === 'debt' ? 'negative' : 'positive'}">
                                    Total: R$ ${subcategoriaTotal.toFixed(2)}
                                    ${subcategoriaTotalPago > 0 ? 
                                        `<span style="font-size: 0.9rem; color: var(--success); margin-left: 10px;">
                                            (${categoria.tipo === 'debt' ? 'Pago' : 'Recebido'}: R$ ${subcategoriaTotalPago.toFixed(2)})
                                        </span>` : ''}
                                </div>
                            </div>
                            <div class="accounts-list">
                                ${contasHtml}
                            </div>
                            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="action-btn secondary" onclick="appState.currentCategoryId = ${categoria.id}; openModal('account', {subcategoryId: ${subcategoria.id}, categoryId: ${categoria.id}})">
                                    <i class="fas fa-plus"></i> Adicionar Conta
                                </button>
                                <button class="action-btn btn-warning" onclick="editSubcategory(${categoria.id}, ${subcategoria.id})">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="action-btn btn-danger" onclick="showConfirmation(
                                    () => deleteSubcategory(${categoria.id}, ${subcategoria.id}),
                                    'Excluir Subcategoria',
                                    'Tem certeza que deseja excluir a subcategoria \"${subcategoria.nome}\"? Todas as contas serão excluídas.',
                                    'danger'
                                )">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                if (!subcategoriasHtml && appState.filters.period !== 'all') return;
                
                html += `
                    <div class="category-card">
                        <div class="category-header">
                            <div class="category-title">
                                <div class="category-icon" style="background: ${categoria.color || categoryColors[0]}">
                                    <i class="fas ${icon}"></i>
                                </div>
                                <div class="category-info">
                                    <h3>${categoria.nome}</h3>
                                    <span class="category-type ${categoria.tipo === 'debt' ? 'type-debt' : 'type-income'}">
                                        ${categoria.tipo === 'debt' ? 'Dívida' : 'Entrada'}
                                    </span>
                                </div>
                            </div>
                            <div class="category-total ${categoria.tipo === 'debt' ? 'negative' : 'positive'}">
                                Total: R$ ${categoriaTotal.toFixed(2)}
                                ${categoriaTotalPago > 0 ? 
                                    `<div style="font-size: 1rem; color: var(--success); margin-top: 5px;">
                                        ${categoria.tipo === 'debt' ? 'Pago' : 'Recebido'}: R$ ${categoriaTotalPago.toFixed(2)}
                                    </div>` : ''}
                            </div>
                        </div>
                        <div class="category-actions">
                            <button class="action-btn secondary" onclick="appState.currentCategoryId = ${categoria.id}; openModal('subcategory')">
                                <i class="fas fa-plus"></i> Adicionar Subcategoria
                            </button>
                            <button class="action-btn btn-warning" onclick="editCategory(${categoria.id})">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="action-btn btn-danger" onclick="showConfirmation(
                                () => deleteCategory(${categoria.id}),
                                'Excluir Categoria',
                                'Tem certeza que deseja excluir a categoria \"${categoria.nome}\"? Todas as subcategorias e contas serão excluídas.',
                                'danger'
                            )">
                                <i class="fas fa-trash"></i> Excluir
                            </button>
                        </div>
                        <div class="subcategories-container">
                            ${subcategoriasHtml || `
                                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                                    <i class="fas fa-inbox fa-3x" style="opacity: 0.3; margin-bottom: 20px;"></i>
                                    <p>Nenhuma subcategoria cadastrada</p>
                                </div>
                            `}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function renderFixedExpenses() {
            const container = document.getElementById('fixed-expenses-list');
            
            if (finances.gastosFixos.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>Nenhum gasto fixo cadastrado</h3>
                        <p>Adicione seus gastos fixos mensais como aluguel, internet, etc.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            finances.gastosFixos.forEach(gasto => {
                const categoria = finances.categorias.find(c => c.id == gasto.categoriaId);
                
                html += `
                    <div class="category-card">
                        <div class="category-header">
                            <div class="category-title">
                                <div class="category-icon" style="background: var(--warning)">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="category-info">
                                    <h3>${gasto.nome}</h3>
                                    <span class="category-type type-debt" style="background: rgba(250, 166, 26, 0.15); color: var(--warning);">
                                        Gasto Fixo
                                    </span>
                                </div>
                            </div>
                            <div class="category-total warning">
                                R$ ${gasto.valor.toFixed(2)}
                            </div>
                        </div>
                        <div class="subcategories-container">
                            <div class="subcategory-card">
                                <div class="account-details">
                                    <div class="account-detail">
                                        <i class="fas fa-calendar-day"></i> Vence todo dia ${gasto.diaVencimento}
                                    </div>
                                    ${categoria ? `
                                        <div class="account-detail">
                                            <i class="fas fa-tag"></i> ${categoria.nome}
                                        </div>
                                    ` : ''}
                                    ${gasto.descricao ? `
                                        <div class="account-detail">
                                            <i class="fas fa-align-left"></i> ${gasto.descricao}
                                        </div>
                                    ` : ''}
                                    <div class="account-detail">
                                        <i class="fas fa-power-off"></i> Status: ${gasto.ativo ? 
                                            '<span style="color: var(--success);">Ativo</span>' : 
                                            '<span style="color: var(--danger);">Inativo</span>'}
                                    </div>
                                    <div class="account-detail">
                                        <i class="fas fa-check-circle"></i> Pago: ${gasto.paga ? 
                                            '<span style="color: var(--success);">Sim</span>' : 
                                            '<span style="color: var(--warning);">Não</span>'}
                                    </div>
                                </div>
                                <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                                    <button class="action-btn btn-warning" onclick="editFixedExpense(${gasto.id})">
                                        <i class="fas fa-edit"></i> Editar
                                    </button>
                                    <button class="action-btn btn-danger" onclick="showConfirmation(
                                        () => deleteFixedExpense(${gasto.id}),
                                        'Excluir Gasto Fixo',
                                        'Tem certeza que deseja excluir o gasto fixo \"${gasto.nome}\"?',
                                        'danger'
                                    )">
                                        <i class="fas fa-trash"></i> Excluir
                                    </button>
                                    <button class="action-btn ${gasto.paga ? 'btn-warning' : 'btn-success'}" onclick="toggleFixedExpensePaid(${gasto.id})">
                                        <i class="fas ${gasto.paga ? 'fa-undo' : 'fa-check'}"></i> ${gasto.paga ? 'Marcar como Não Pago' : 'Marcar como Pago'}
                                    </button>
                                    <button class="action-btn ${gasto.ativo ? 'btn-danger' : 'btn-success'}" onclick="toggleFixedExpenseActive(${gasto.id})">
                                        <i class="fas fa-power-off"></i> ${gasto.ativo ? 'Desativar' : 'Ativar'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function renderSalaries() {
            const container = document.getElementById('salary-list');
            
            if (finances.salarios.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <i class="fas fa-money-bill-wave"></i>
                        <h3>Nenhuma entrada cadastrada</h3>
                        <p>Adicione suas fontes de renda</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            finances.salarios.forEach(salario => {
                const frequenciaText = {
                    'monthly': 'Mensal',
                    'biweekly': 'Quinzenal',
                    'weekly': 'Semanal',
                    'daily': 'Diária',
                    'single': 'Única vez'
                }[salario.frequencia] || salario.frequencia;
                
                const valorMensal = calcularValorMensal(salario.valor, salario.frequencia);
                
                html += `
                    <div class="category-card">
                        <div class="category-header">
                            <div class="category-title">
                                <div class="category-icon" style="background: var(--success)">
                                    <i class="fas fa-money-check-alt"></i>
                                </div>
                                <div class="category-info">
                                    <h3>${salario.nome}</h3>
                                    <span class="category-type type-income">
                                        ${frequenciaText}
                                    </span>
                                </div>
                            </div>
                            <div class="category-total positive">
                                R$ ${salario.valor.toFixed(2)}
                                <div style="font-size: 1rem; color: var(--text-secondary); margin-top: 5px;">
                                    Mensal: R$ ${valorMensal.toFixed(2)}
                                </div>
                            </div>
                        </div>
                        <div class="subcategories-container">
                            <div class="subcategory-card">
                                <div class="account-details">
                                    <div class="account-detail">
                                        <i class="fas fa-calendar-day"></i> Recebe todo dia ${salario.diaPagamento}
                                    </div>
                                    <div class="account-detail">
                                        <i class="fas fa-history"></i> Frequência: ${frequenciaText}
                                    </div>
                                    ${salario.descricao ? `
                                        <div class="account-detail">
                                            <i class="fas fa-align-left"></i> ${salario.descricao}
                                        </div>
                                    ` : ''}
                                    <div class="account-detail">
                                        <i class="fas fa-check-circle"></i> Status: ${salario.recebida ? 
                                            '<span style="color: var(--success);">Recebida</span>' : 
                                            '<span style="color: var(--warning);">Pendente</span>'}
                                    </div>
                                </div>
                                <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                                    <button class="action-btn btn-warning" onclick="editSalary(${salario.id})">
                                        <i class="fas fa-edit"></i> Editar
                                    </button>
                                    <button class="action-btn btn-danger" onclick="showConfirmation(
                                        () => deleteSalary(${salario.id}),
                                        'Excluir Entrada',
                                        'Tem certeza que deseja excluir a entrada \"${salario.nome}\"?',
                                        'danger'
                                    )">
                                        <i class="fas fa-trash"></i> Excluir
                                    </button>
                                    <button class="action-btn ${salario.recebida ? 'btn-warning' : 'btn-success'}" onclick="toggleSalaryReceived(${salario.id})">
                                        <i class="fas ${salario.recebida ? 'fa-undo' : 'fa-check'}"></i> ${salario.recebida ? 'Marcar como Pendente' : 'Marcar como Recebida'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function calcularValorMensal(valor, frequencia) {
            switch(frequencia) {
                case 'monthly': return valor;
                case 'biweekly': return valor * 2;
                case 'weekly': return valor * 4;
                case 'daily': return valor * 30;
                case 'single': return valor;
                default: return valor;
            }
        }

        function updateDashboard() {
            let totalDebts = 0;
            let totalIncomes = 0;
            let paidDebts = 0;
            let receivedIncomes = 0;
            let pendingFixed = 0;
            let totalSalaries = 0;
            let nextDueAmount = 0;
            
            finances.categorias.forEach(categoria => {
                categoria.subcategorias.forEach(subcategoria => {
                    subcategoria.contas.forEach(conta => {
                        if (categoria.tipo === 'debt') {
                            if (!conta.paga) {
                                totalDebts += conta.valor;
                                
                                const contaDate = new Date(conta.dataPagamento);
                                const now = new Date();
                                const diffDays = Math.ceil((contaDate - now) / (1000 * 60 * 60 * 24));
                                
                                if (diffDays >= 0 && diffDays <= 7) {
                                    nextDueAmount += conta.valor;
                                }
                            } else {
                                paidDebts += conta.valor;
                            }
                        } else {
                            if (!conta.paga) {
                                totalIncomes += conta.valor;
                            } else {
                                receivedIncomes += conta.valor;
                            }
                        }
                    });
                });
            });
            
            finances.gastosFixos.forEach(gasto => {
                if (gasto.ativo && !gasto.paga) {
                    pendingFixed += gasto.valor;
                    totalDebts += gasto.valor;
                }
            });
            
            finances.salarios.forEach(salario => {
                if (salario.ativo) {
                    const valorMensal = calcularValorMensal(salario.valor, salario.frequencia);
                    totalSalaries += valorMensal;
                    if (!salario.recebida) {
                        totalIncomes += valorMensal;
                    } else {
                        receivedIncomes += valorMensal;
                    }
                }
            });
            
            const totalBalance = (totalIncomes + totalSalaries) - (totalDebts + pendingFixed);
            
            document.getElementById('total-debts').textContent = `R$ ${totalDebts.toFixed(2)}`;
            document.getElementById('total-incomes').textContent = `R$ ${totalIncomes.toFixed(2)}`;
            document.getElementById('total-balance').textContent = `R$ ${totalBalance.toFixed(2)}`;
            document.getElementById('next-due').textContent = `R$ ${nextDueAmount.toFixed(2)}`;
            document.getElementById('paid-debts').textContent = `R$ ${paidDebts.toFixed(2)}`;
            document.getElementById('received-incomes').textContent = `R$ ${receivedIncomes.toFixed(2)}`;
            document.getElementById('pending-fixed').textContent = `R$ ${pendingFixed.toFixed(2)}`;
            document.getElementById('total-salaries').textContent = `R$ ${totalSalaries.toFixed(2)}`;
            
            const balanceElement = document.getElementById('total-balance');
            balanceElement.className = `stat-value ${totalBalance >= 0 ? 'positive' : 'negative'}`;
        }

        function updateCounts() {
            let totalTransactions = 0;
            finances.categorias.forEach(categoria => {
                categoria.subcategorias.forEach(subcategoria => {
                    totalTransactions += subcategoria.contas.length;
                });
            });
            
            document.getElementById('transactions-count').textContent = totalTransactions;
            document.getElementById('fixed-expenses-count').textContent = finances.gastosFixos.length;
            document.getElementById('salary-count').textContent = finances.salarios.length;
        }

        function applyFilters() {
            appState.filters.period = document.getElementById('filter-period').value;
            appState.filters.type = document.getElementById('filter-type').value;
            appState.filters.category = document.getElementById('filter-category').value;
            appState.filters.status = document.getElementById('filter-status').value;
            
            renderAll();
        }

        function resetFilters() {
            document.getElementById('filter-period').value = 'all';
            document.getElementById('filter-type').value = 'all';
            document.getElementById('filter-category').value = 'all';
            document.getElementById('filter-status').value = 'all';
            
            appState.filters.period = 'all';
            appState.filters.type = 'all';
            appState.filters.category = 'all';
            appState.filters.status = 'all';
            
            renderAll();
        }

        function updateFilterOptions() {
            const filterCategory = document.getElementById('filter-category');
            filterCategory.innerHTML = '<option value="all">Todas categorias</option>';
            
            finances.categorias.forEach(categoria => {
                const option = document.createElement('option');
                option.value = categoria.id;
                option.textContent = categoria.nome;
                filterCategory.appendChild(option);
            });
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('pt-BR');
        }

        window.markAsPaid = function(categoriaId, subcategoriaId, accountId) {
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            const subcategoria = categoria.subcategorias.find(sub => sub.id == subcategoriaId);
            if (!subcategoria) return;
            
            const conta = subcategoria.contas.find(acc => acc.id == accountId);
            if (conta) {
                conta.paga = true;
                conta.dataPagamentoRealizada = new Date().toISOString().split('T')[0];
                saveData();
                renderAll();
                updateDashboard();
            }
        };

        window.markAsPending = function(categoriaId, subcategoriaId, accountId) {
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            const subcategoria = categoria.subcategorias.find(sub => sub.id == subcategoriaId);
            if (!subcategoria) return;
            
            const conta = subcategoria.contas.find(acc => acc.id == accountId);
            if (conta) {
                conta.paga = false;
                conta.dataPagamentoRealizada = null;
                saveData();
                renderAll();
                updateDashboard();
            }
        };

        window.toggleFixedExpensePaid = function(id) {
            const gasto = finances.gastosFixos.find(g => g.id == id);
            if (gasto) {
                gasto.paga = !gasto.paga;
                saveData();
                renderAll();
                updateDashboard();
            }
        };

        window.toggleFixedExpenseActive = function(id) {
            const gasto = finances.gastosFixos.find(g => g.id == id);
            if (gasto) {
                gasto.ativo = !gasto.ativo;
                saveData();
                renderAll();
                updateDashboard();
            }
        };

        window.toggleSalaryReceived = function(id) {
            const salario = finances.salarios.find(s => s.id == id);
            if (salario) {
                salario.recebida = !salario.recebida;
                saveData();
                renderAll();
                updateDashboard();
            }
        };

        window.editCategory = function(id) {
            const categoria = finances.categorias.find(cat => cat.id == id);
            if (categoria) {
                openModal('category', categoria);
            }
        };

        window.editSubcategory = function(categoriaId, subcategoriaId) {
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            const subcategoria = categoria.subcategorias.find(sub => sub.id == subcategoriaId);
            if (!subcategoria) return;
            
            appState.currentCategoryId = categoriaId;
            openModal('subcategory', subcategoria);
        };

        window.editAccount = function(categoriaId, subcategoriaId, accountId) {
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            const subcategoria = categoria.subcategorias.find(sub => sub.id == subcategoriaId);
            if (!subcategoria) return;
            
            const conta = subcategoria.contas.find(acc => acc.id == accountId);
            if (!conta) return;
            
            appState.currentCategoryId = categoriaId;
            conta.categoryId = categoriaId;
            conta.subcategoryId = subcategoriaId;
            openModal('account', conta);
        };

        window.editFixedExpense = function(id) {
            const gasto = finances.gastosFixos.find(g => g.id == id);
            if (gasto) {
                openModal('fixed-expense', gasto);
            }
        };

        window.editSalary = function(id) {
            const salario = finances.salarios.find(s => s.id == id);
            if (salario) {
                openModal('salary', salario);
            }
        };

        window.deleteCategory = function(id) {
            finances.categorias = finances.categorias.filter(cat => cat.id != id);
            saveData();
            renderAll();
            updateFilterOptions();
            updateDashboard();
        };

        window.deleteSubcategory = function(categoriaId, subcategoriaId) {
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (categoria) {
                categoria.subcategorias = categoria.subcategorias.filter(sub => sub.id != subcategoriaId);
                saveData();
                renderAll();
                updateDashboard();
            }
        };

        window.deleteAccount = function(categoriaId, subcategoriaId, accountId) {
            const categoria = finances.categorias.find(cat => cat.id == categoriaId);
            if (!categoria) return;
            
            const subcategoria = categoria.subcategorias.find(sub => sub.id == subcategoriaId);
            if (!subcategoria) return;
            
            const conta = subcategoria.contas.find(acc => acc.id == accountId);
            if (conta && conta.parcelamento) {
                subcategoria.contas = subcategoria.contas.filter(acc => 
                    !acc.parcelamento || acc.parcelamento.idOriginal !== conta.parcelamento.idOriginal
                );
            } else {
                subcategoria.contas = subcategoria.contas.filter(acc => acc.id != accountId);
            }
            
            saveData();
            renderAll();
            updateDashboard();
        };

        window.deleteFixedExpense = function(id) {
            finances.gastosFixos = finances.gastosFixos.filter(g => g.id != id);
            saveData();
            renderAll();
            updateDashboard();
        };

        window.deleteSalary = function(id) {
            finances.salarios = finances.salarios.filter(s => s.id != id);
            saveData();
            renderAll();
            updateDashboard();
        };
    </script>
</body>
</html>